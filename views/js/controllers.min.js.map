{"version":3,"file":"taoDelivery/controller/routes.js","sources":["routes.js","delivery/editDelivery.js","delivery/testtaker.js","tpl!taoDelivery/tpl/fullscreen-modal-feedback","runtime/fullScreen.js","runtime/deliveryExecution.js"],"names":["define","Delivery","actions","editDelivery","excludeTesttaker","$","helpers","start","click","delivery","this","data","load","_url","uri","prepend","modal","__","module","section","feedback","switchList","target","current","parent","attr","append","scrollIntoView","timeout","$search","$list","liveSearch","pattern","val","clearTimeout","setTimeout","filterList","RegExp","regex","list","children","each","index","element","text","match","hide","show","excluded","push","assemblyUri","ajax","url","type","JSON","stringify","dataType","success","response","saved","loadContentBlock","keyup","siblings","hb","template","Handlebars","depth0","partials","program1","stack1","helper","buffer","launchButton","call","hash","functionType","escapeExpression","program3","options","helperMissing","program5","compilerInfo","merge","self","unless","fsSupported","inverse","noop","fn","program","dialogTpl","$dialog","$body","d","document","dElem","documentElement","fs","_fs","isSupported","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","fullscreenchange","prefixes","i","length","fullScreen","fullscreenElement","mozFullScreen","webkitIsFullScreen","screen","availHeight","height","window","innerHeight","changeInterval","awaitFsChange","event","createEvent","initEvent","setInterval","dispatchEvent","handleUserInput","evt","keyCode","which","className","init","body","addEventListener","replace","navigator","platform","toLowerCase","indexOf","querySelector","e","on","clearInterval","width","disableClosing","startClosed","iframeResizer","context","loadingBar","resizeMainFrame","outerHeight","$headerHeight","$footerHeight","$frameContainer","$frame","deliveryServerConfig","requireFullScreen","find","location","root_url","serviceApi","onFinish","finishDeliveryExecution","deliveryExecution","destination","stop","off","loadInto","get","bind"],"mappings":"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BAAAqJ,eAAA,EAEArJ,EAAAyF,UAAAmD,GAAA,mBAAA,WACAxB,OAAAyC,SAAAX,QAAAY,SAAA,mBAGA,IAAAC,YAAAtF,QAAAsF,UAEAA,YAAAC,SAAA,WACAhK,EAAA8C,MACAC,IAAA0B,QAAAwF;ALjDA,AKkDA3J,MACA4J,kBAAAzF,QAAAyF,mBAEAlH,KAAA,OACAG,SAAA,OACAC,QAAA,SAAA9C,MACA8G,OAAAyC,SAAAvJ,KAAA6J,iBAKAnK,EAAAyF,UACAmD,GAAA,UAAA,SAAAD,GACAQ,WAAAjJ,UAEA0I,GAAA,YAAA,WACA9G,WAAA,WACAqH,WAAAiB,QACA,OAEAxB,GAAA,eAAA,WAEA5I,EAAAyF,UAAA4E,IAAA,gBACAZ,OAAAY,IAAA,oBACAA,IAAA,eAGAN,WAAAO,SAAAb,OAAAc,IAAA,IAEAvK,EAAAoH,QAAAoD,KAAA,SAAA,WACApB,oBAGAA;ALlFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA,ADkCA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA,ADiDA;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClLA,ADmLA;AClLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n * \n * \n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoDelivery/controller/routes',[],function(){\n    'use strict';\n\n    return {\n        'Delivery': {\n            'actions' : {\n            \t'editDelivery'     : 'controller/delivery/editDelivery',\n\t            'excludeTesttaker' : 'controller/delivery/testtaker'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/delivery/editDelivery',['jquery', 'helpers', 'ui/modal'],\nfunction ($, helpers) {\n\t'use strict';\n\t\n\treturn {\n        start : function(){\n            $('#exclude-btn').click(function() {\n            \tvar delivery = $(this).data('delivery');\n        \t    $('#testtaker-form').load(helpers._url('excludeTesttaker', 'Delivery', 'taoDelivery', {'uri' : delivery}), function() {\n                    $('body').prepend($('#modal-container'));\n                    $('#testtaker-form').modal();\n                });\n        \t});\n        }\n\t}\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/delivery/testtaker',['jquery', 'i18n', 'helpers', 'module', 'layout/section', 'ui/feedback'], \nfunction ($, __, helpers, module, section, feedback) {\n    'use strict';\n\n\tfunction switchList() {\n\t\tvar current = $(this).parent().attr('id');\n        var target; \n\t\tif (current == 'excludedList') {\n\t\t\ttarget = $('#assignedList'); \n\t\t} else if (current == 'assignedList') {\n\t\t\ttarget = $('#excludedList');\n\t\t}\n\t\tif (typeof target !== 'undefined') {\n\t\t\ttarget.append(this);\n\t\t\tthis.scrollIntoView();\n\t\t}\n\t}\n\t\n\tvar $search = $('#tt-filter');\n    var $list   = $('#assignedList');\n    var timeout;\n    \n    var liveSearch = function(){\n        var pattern = $search.val();\n        clearTimeout(timeout);\n        timeout = setTimeout(function(){\n        \tfilterList(new RegExp(pattern), $list);\n        }, 300);\n    };\n    \n    var filterList = function(regex, list) {\n    \tlist.children().each(function(index, element) {\n    \t\tif ($(element).text().match(regex) === null) {\n    \t\t\t$(element).hide();\n    \t\t} else {\n    \t\t\t$(element).show();\n    \t\t}\n    \t});\n    };\n\t\n    return {\n        start : function(){\n\t        $('#save-tt').click(function() {\n\t        \tvar excluded = [];\n\t        \t$('#excludedList > li').each(function(index) {\n\t        \t\texcluded.push($(this).data('uri'));\n\t        \t});\n\t        \tvar assemblyUri = $('input[name=\"assemblyUri\"]').val();\n\t        \t$.ajax({\n\t        \t\turl: helpers._url('saveExcluded', 'Delivery', 'taoDelivery'),\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: {\n\t\t\t\t\t\turi: assemblyUri,\n\t\t\t\t\t\texcluded: JSON.stringify(excluded)\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif (response.saved) {\n                            feedback().success(__('Selection saved successfully'));\n                            section.loadContentBlock(helpers._url('editDelivery', 'Delivery', 'taoDelivery'), {uri: assemblyUri});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t        });\n        \t$('#assignedList > li').click(switchList);\n        \t$('#excludedList > li').click(switchList);\n        \t\n        \t$('#close-tt').click(function() {\n        \t\t$('#testtaker-form').modal('close');\n        \t});\n                \n            //trigger the search on keyp and on the magnifer button click\n            $search.keyup(liveSearch).siblings('.ctrl').click(liveSearch);\n        \t\n        }\n    };\n});\n\n\n\n","\ndefine('tpl!taoDelivery/tpl/fullscreen-modal-feedback', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"(\";\n  if (helper = helpers.launchButton) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.launchButton); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n            <button class=\\\"btn-info small enter-full-screen\\\" type=\\\"button\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enter full screen\", options) : helperMissing.call(depth0, \"__\", \"Enter full screen\", options)))\n    + \"</button>\\n            \";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n            <button class=\\\"btn-info small close-full-screen-prompt\\\" type=\\\"button\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Close this prompt\", options) : helperMissing.call(depth0, \"__\", \"Close this prompt\", options)))\n    + \"</button>\\n            \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"modal-feedback modal full-screen-modal\\\">\\n    <div class=\\\"modal-body clearfix\\\">\\n        <p class=\\\"message\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This test needs to be taken in full screen mode\", options) : helperMissing.call(depth0, \"__\", \"This test needs to be taken in full screen mode\", options)))\n    + \"\\n            \";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.fsSupported), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </p>\\n        <div class=\\\"rgt\\\">\\n            \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.fsSupported), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </div>\\n    </div>\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n *\n * @author dieter <dieter@taotesting.com>\n */\ndefine('taoDelivery/controller/runtime/fullScreen',[\n    'jquery',\n    'i18n',\n    'ui/feedback',\n    'ui/modal',\n    'tpl!taoDelivery/tpl/fullscreen-modal-feedback'\n], function ($, __, feedback, modal, dialogTpl) {\n    'use strict';\n\n    var $dialog;\n    var $body;\n    var d = document;\n    var dElem = d.documentElement;\n\n    var fs = (function() {\n       var _fs = {\n                isSupported: (!!d.exitFullscreen ||\n                    !!d.msExitFullscreen ||\n                    !!d.mozCancelFullScreen ||\n                    !!d.webkitExitFullscreen),\n                requestFullscreen: (dElem.requestFullscreen ||\n                    dElem.msRequestFullscreen ||\n                    dElem.mozRequestFullScreen ||\n                    (function() {\n                        dElem.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n                    })),\n                fullscreenchange: (function() {\n                    var prefixes = ['', 'ms', 'moz', 'webkit'],\n                        i = prefixes.length;\n                    while(i--) {\n                        if('on' + prefixes[i] + 'fullscreenchange' in dElem) {\n                            return prefixes[i] + 'fullscreenchange';\n                        }\n                    }\n                    return 'myfullscreenchange';\n                }()),\n                fullScreen: function() {\n                    return ((document.fullscreenElement && document.fullscreenElement !== null) ||\n                        document.mozFullScreen ||\n                        document.webkitIsFullScreen ||\n                        (screen.availHeight || screen.height - 30) <= window.innerHeight);\n                }\n            };\n\n        _fs.changeInterval = null;\n\n        // on older browsers wait for a full screen change to happen\n        // and fire the change event manually\n        _fs.awaitFsChange = function() {\n            var event = document.createEvent('Event');\n            event.initEvent(_fs.fullscreenchange, true, true);\n            _fs.changeInterval = setInterval(function() {\n                if(!_fs.fullScreen()) {\n                    document.dispatchEvent(event);\n                }\n            }, 2000);\n        };\n        \n        if(!_fs.isSupported) {\n            _fs.awaitFsChange();\n        }\n\n        return _fs;\n    }());\n\n\n    /**\n     * React to user input on the prompt which is either\n     * key press or click on the button\n     *\n     * @param evt\n     */\n    var handleUserInput = function handleUserInput (evt) {\n\n        // full screen needs to be initiated by pressing\n        // F11 (Windows/Linux) or Ctrl+Cmd+F (Mac)\n        if(!fs.isSupported) {\n            $dialog.modal('close');\n            return;\n        }\n\n        // accept 'enter' as only valid key stroke\n        if(evt.type === 'keydown' && (evt.keyCode || evt.which) !== 13) {\n            return;\n        }\n\n        // in all other cases either 'enter' has been hit or the enter button has been clicked\n        fs.requestFullscreen.call(dElem);\n        dElem.className += ' fullscreen';\n        $dialog.modal('close');\n    };\n\n\n    /**\n     * Initialize full screen\n     */\n    var init = function init() {\n\n        $body = $(document.body);\n\n        // listen either to the native or the change event created in the observer above\n        document.addEventListener(fs.fullscreenchange, function() {\n            if(!fs.fullScreen()) {\n                dElem.className = dElem.className.replace(/\\bfullscreen\\b/, '');\n                $dialog.modal('open');\n            }\n        });\n\n        modal($body);\n        $dialog = $(dialogTpl({\n            fsSupported: fs.isSupported,\n            // while this is vague chances that any Mac browser gets here are very little\n            launchButton: navigator.platform.toLowerCase().indexOf('Mac') === 0 ? 'Ctrl+⌘+F' : 'F11'\n        }));\n\n        $dialog[0].querySelector('button').addEventListener('click', function(e) {\n            handleUserInput(e);\n        });\n\n        document.addEventListener('keydown', function(e) {\n            if(!fs.fullScreen()) {\n                handleUserInput(e);\n            }\n        });\n\n        $dialog.on('opened.modal', function() {\n            clearInterval(fs.changeInterval);\n        });\n\n        $dialog.on('closed.modal', function() {\n            fs.awaitFsChange();\n        });\n\n        $body.append($dialog);\n        \n        $dialog.modal({\n            width: 500,\n            disableClosing: true,\n            startClosed: true\n        });\n\n        // Note that when a page is on full screen already on load (after F5 normally)\n        // fullscreenElement and therefor fs.fullScreen() will report the wrong value!\n        if(false === ((screen.availHeight || screen.height - 30) <= window.innerHeight)) {\n            $dialog.modal('open');\n        }\n    };\n\n    /**\n     * @exports\n     */\n    return {\n        init: init\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/runtime/deliveryExecution',[\n    'jquery',\n    'iframeResizer',\n    'context',\n    'taoDelivery/controller/runtime/fullScreen',\n    'layout/loading-bar'\n], function($, iframeResizer, context, fullScreen, loadingBar){\n\n    'use strict';\n\n    var $frameContainer,\n        $frame,\n        $headerHeight,\n        $footerHeight;\n\n    function resizeMainFrame() {\n        var height = $(window).outerHeight() - $headerHeight - $footerHeight;\n        $frameContainer.height(height);\n        $frame.height(height);\n    }\n\n    return {\n        start: function(options){\n\n            if(!!options.deliveryServerConfig.requireFullScreen){\n                fullScreen.init();\n            }\n\n            $frameContainer = $('#outer-delivery-iframe-container');\n            $frame = $frameContainer.find('iframe');\n            $headerHeight = $('body > .content-wrap > header').outerHeight() || 0;\n            $footerHeight = $('body > footer').outerHeight() || 0;\n\n            $(document).on('serviceforbidden', function() {\n                window.location = context.root_url + 'tao/Main/logout';\n            });\n\n            var serviceApi = options.serviceApi;\n\n            serviceApi.onFinish(function() {\n                $.ajax({\n                    url : options.finishDeliveryExecution,\n                    data : {\n                        'deliveryExecution' : options.deliveryExecution\n                    },\n                    type : 'post',\n                    dataType : 'json',\n                    success : function(data) {\n                        window.location = data.destination;\n                    }\n                });\n            });\n\n            $(document)\n                .on('loading', function(e){\n                    loadingBar.start();\n                })\n                .on('unloading', function(){\n                    setTimeout(function(){\n                        loadingBar.stop();\n                    }, 300);\n                })\n                .on('shutdown-com', function(){\n                    //use when we want to stop all exchange between frames\n                    $(document).off('heightchange');\n                    $frame.off('load.eventHeight')\n                           .off('load.cors');\n                });\n\n            serviceApi.loadInto($frame.get(0));\n\n            $(window).bind('resize', function() {\n                resizeMainFrame();\n            });\n\n            resizeMainFrame();\n        }\n    };\n});\n\n"]}