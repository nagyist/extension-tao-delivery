{"version":3,"file":"routes.js","sources":["routes.js","delivery/editDelivery.js","delivery/testtaker.js","../../lib/spin.min.js","runtime/deliveryExecution.js","runtime/index.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n * \n * \n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoDelivery/controller/routes',[],function(){\n    'use strict';\n\n    return {\n        'Delivery': {\n            'actions' : {\n            \t'editDelivery'     : 'controller/delivery/editDelivery',\n\t            'excludeTesttaker' : 'controller/delivery/testtaker'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/delivery/editDelivery',['jquery', 'helpers', 'ui/modal'],\nfunction ($, helpers) {\n\t'use strict';\n\t\n\treturn {\n        start : function(){\n            $('#exclude-btn').click(function() {\n            \tvar delivery = $(this).data('delivery');\n        \t    $('#testtaker-form').load(helpers._url('excludeTesttaker', 'Delivery', 'taoDelivery', {'uri' : delivery}), function() {\n                    $('body').prepend($('#modal-container'));\n                    $('#testtaker-form').modal();\n                });\n        \t});\n        }\n\t}\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/delivery/testtaker',['jquery', 'i18n', 'helpers', 'module', 'layout/section', 'ui/feedback'], \nfunction ($, __, helpers, module, section, feedback) {\n    'use strict';\n\n\tfunction switchList() {\n\t\tvar current = $(this).parent().attr('id');\n        var target; \n\t\tif (current == 'excludedList') {\n\t\t\ttarget = $('#assignedList'); \n\t\t} else if (current == 'assignedList') {\n\t\t\ttarget = $('#excludedList');\n\t\t}\n\t\tif (typeof target !== 'undefined') {\n\t\t\ttarget.append(this);\n\t\t\tthis.scrollIntoView();\n\t\t}\n\t}\n\t\n\tvar $search = $('#tt-filter');\n    var $list   = $('#assignedList');\n    var timeout;\n    \n    var liveSearch = function(){\n        var pattern = $search.val();\n        clearTimeout(timeout);\n        timeout = setTimeout(function(){\n        \tfilterList(new RegExp(pattern), $list);\n        }, 300);\n    };\n    \n    var filterList = function(regex, list) {\n    \tlist.children().each(function(index, element) {\n    \t\tif ($(element).text().match(regex) === null) {\n    \t\t\t$(element).hide();\n    \t\t} else {\n    \t\t\t$(element).show();\n    \t\t}\n    \t});\n    };\n\t\n    return {\n        start : function(){\n\t        $('#save-tt').click(function() {\n\t        \tvar excluded = [];\n\t        \t$('#excludedList > li').each(function(index) {\n\t        \t\texcluded.push($(this).data('uri'));\n\t        \t});\n\t        \tvar assemblyUri = $('input[name=\"assemblyUri\"]').val();\n\t        \t$.ajax({\n\t        \t\turl: helpers._url('saveExcluded', 'Delivery', 'taoDelivery'),\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: {\n\t\t\t\t\t\turi: assemblyUri,\n\t\t\t\t\t\texcluded: JSON.stringify(excluded)\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif (response.saved) {\n                            feedback().success(__('Selection saved successfully'));\n                            section.loadContentBlock(helpers._url('editDelivery', 'Delivery', 'taoDelivery'), {uri: assemblyUri});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t        });\n        \t$('#assignedList > li').click(switchList);\n        \t$('#excludedList > li').click(switchList);\n        \t\n        \t$('#close-tt').click(function() {\n        \t\t$('#testtaker-form').modal('close');\n        \t});\n                \n            //trigger the search on keyp and on the magnifer button click\n            $search.keyup(liveSearch).siblings('.ctrl').click(liveSearch);\n        \t\n        }\n    };\n});\n\n\n\n","(function(t,e){if(typeof exports==\"object\")module.exports=e();else if(typeof define==\"function\"&&define.amd)define('spin',e);else t.Spinner=e()})(this,function(){\"use strict\";var t=[\"webkit\",\"Moz\",\"ms\",\"O\"],e={},i;function o(t,e){var i=document.createElement(t||\"div\"),o;for(o in e)i[o]=e[o];return i}function n(t){for(var e=1,i=arguments.length;e<i;e++)t.appendChild(arguments[e]);return t}var r=function(){var t=o(\"style\",{type:\"text/css\"});n(document.getElementsByTagName(\"head\")[0],t);return t.sheet||t.styleSheet}();function s(t,o,n,s){var a=[\"opacity\",o,~~(t*100),n,s].join(\"-\"),f=.01+n/s*100,l=Math.max(1-(1-t)/o*(100-f),t),u=i.substring(0,i.indexOf(\"Animation\")).toLowerCase(),d=u&&\"-\"+u+\"-\"||\"\";if(!e[a]){r.insertRule(\"@\"+d+\"keyframes \"+a+\"{\"+\"0%{opacity:\"+l+\"}\"+f+\"%{opacity:\"+t+\"}\"+(f+.01)+\"%{opacity:1}\"+(f+o)%100+\"%{opacity:\"+t+\"}\"+\"100%{opacity:\"+l+\"}\"+\"}\",r.cssRules.length);e[a]=1}return a}function a(e,i){var o=e.style,n,r;i=i.charAt(0).toUpperCase()+i.slice(1);for(r=0;r<t.length;r++){n=t[r]+i;if(o[n]!==undefined)return n}if(o[i]!==undefined)return i}function f(t,e){for(var i in e)t.style[a(t,i)||i]=e[i];return t}function l(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)if(t[o]===undefined)t[o]=i[o]}return t}function u(t){var e={x:t.offsetLeft,y:t.offsetTop};while(t=t.offsetParent)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}function d(t,e){return typeof t==\"string\"?t:t[e%t.length]}var p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:\"#000\",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:\"spinner\",top:\"auto\",left:\"auto\",position:\"relative\"};function c(t){if(typeof this==\"undefined\")return new c(t);this.opts=l(t||{},c.defaults,p)}c.defaults={};l(c.prototype,{spin:function(t){this.stop();var e=this,n=e.opts,r=e.el=f(o(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex}),s=n.radius+n.length+n.width,a,l;if(t){t.insertBefore(r,t.firstChild||null);l=u(t);a=u(r);f(r,{left:(n.left==\"auto\"?l.x-a.x+(t.offsetWidth>>1):parseInt(n.left,10)+s)+\"px\",top:(n.top==\"auto\"?l.y-a.y+(t.offsetHeight>>1):parseInt(n.top,10)+s)+\"px\"})}r.setAttribute(\"role\",\"progressbar\");e.lines(r,e.opts);if(!i){var d=0,p=(n.lines-1)*(1-n.direction)/2,c,h=n.fps,m=h/n.speed,y=(1-n.opacity)/(m*n.trail/100),g=m/n.lines;(function v(){d++;for(var t=0;t<n.lines;t++){c=Math.max(1-(d+(n.lines-t)*g)%m*y,n.opacity);e.opacity(r,t*n.direction+p,c,n)}e.timeout=e.el&&setTimeout(v,~~(1e3/h))})()}return e},stop:function(){var t=this.el;if(t){clearTimeout(this.timeout);if(t.parentNode)t.parentNode.removeChild(t);this.el=undefined}return this},lines:function(t,e){var r=0,a=(e.lines-1)*(1-e.direction)/2,l;function u(t,i){return f(o(),{position:\"absolute\",width:e.length+e.width+\"px\",height:e.width+\"px\",background:t,boxShadow:i,transformOrigin:\"left\",transform:\"rotate(\"+~~(360/e.lines*r+e.rotate)+\"deg) translate(\"+e.radius+\"px\"+\",0)\",borderRadius:(e.corners*e.width>>1)+\"px\"})}for(;r<e.lines;r++){l=f(o(),{position:\"absolute\",top:1+~(e.width/2)+\"px\",transform:e.hwaccel?\"translate3d(0,0,0)\":\"\",opacity:e.opacity,animation:i&&s(e.opacity,e.trail,a+r*e.direction,e.lines)+\" \"+1/e.speed+\"s linear infinite\"});if(e.shadow)n(l,f(u(\"#000\",\"0 0 4px \"+\"#000\"),{top:2+\"px\"}));n(t,n(l,u(d(e.color,r),\"0 0 1px rgba(0,0,0,.1)\")))}return t},opacity:function(t,e,i){if(e<t.childNodes.length)t.childNodes[e].style.opacity=i}});function h(){function t(t,e){return o(\"<\"+t+' xmlns=\"urn:schemas-microsoft.com:vml\" class=\"spin-vml\">',e)}r.addRule(\".spin-vml\",\"behavior:url(#default#VML)\");c.prototype.lines=function(e,i){var o=i.length+i.width,r=2*o;function s(){return f(t(\"group\",{coordsize:r+\" \"+r,coordorigin:-o+\" \"+-o}),{width:r,height:r})}var a=-(i.width+i.length)*2+\"px\",l=f(s(),{position:\"absolute\",top:a,left:a}),u;function p(e,r,a){n(l,n(f(s(),{rotation:360/i.lines*e+\"deg\",left:~~r}),n(f(t(\"roundrect\",{arcsize:i.corners}),{width:o,height:i.width,left:i.radius,top:-i.width>>1,filter:a}),t(\"fill\",{color:d(i.color,e),opacity:i.opacity}),t(\"stroke\",{opacity:0}))))}if(i.shadow)for(u=1;u<=i.lines;u++)p(u,-2,\"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)\");for(u=1;u<=i.lines;u++)p(u);return n(e,l)};c.prototype.opacity=function(t,e,i,o){var n=t.firstChild;o=o.shadow&&o.lines||0;if(n&&e+o<n.childNodes.length){n=n.childNodes[e+o];n=n&&n.firstChild;n=n&&n.firstChild;if(n)n.opacity=i}}}var m=f(o(\"group\"),{behavior:\"url(#default#VML)\"});if(!a(m,\"transform\")&&m.adj)h();else i=a(m,\"animation\");return c});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\ndefine('taoDelivery/controller/runtime/deliveryExecution',['jquery', 'iframeResizer', 'spin', 'context'], function($, iframeResizer, Spinner, context){\n    \n    function loading(reverse) {\n        if($('#overlay').length === 0){\n            \n            $('<div id=\"overlay\"></div>').appendTo(document.body);\n            $('<div id=\"loading\"><div></div></div>').appendTo(document.body);\n        }\n\n        var opts = {\n                lines: 11, // The number of lines to draw\n                length: 21, // The length of each line\n                width: 8, // The line thickness\n                radius: 36, // The radius of the inner circle\n                corners: 1, // Corner roundness (0..1)\n                rotate: 0, // The rotation offset\n                direction: (reverse === true) ? -1 : 1, // 1: clockwise, -1: counterclockwise\n                color: '#888', // #rgb or #rrggbb or array of colors\n                speed: 1.5, // Rounds per second\n                trail: 60, // Afterglow percentage\n                shadow: false, // Whether to render a shadow\n                hwaccel: false, // Whether to use hardware acceleration\n                className: 'spinner', // The CSS class to assign to the spinner\n                zIndex: 2e9, // The z-index (defaults to 2000000000)\n        };\n        new Spinner(opts).spin($('#loading > div').get(0));\n    }\n    \n    function unloading() {\n        setTimeout(function(){\n            $('#loading').fadeOut(300, function(){\n                $(this).remove();\n                $('#overlay').remove();\n            });\n        }, 300);\n    }\n    \n    function resizeMainFrame() {\n        var $frame = $('#iframeDeliveryExec');\n        var windowHeight = $(window).height();\n        var controlHeight = 0;\n        var $control = $('#control');\n        \n        if ($control.length === 1) {\n            controlHeight = $control.outerHeight(true);\n        }\n        \n        var newHeight = windowHeight - controlHeight;\n        \n        if (navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ? true : false == true) {\n            newHeight -= 20;\n        }\n        \n        $frame.css('height', newHeight + 'px');\n    }\n    \n    return {\n        start: function(options){\n            \n            $(document).on('serviceforbidden', function() {\n                window.location = context.root_url + 'tao/Main/logout';\n            });\n\n            var $frame = $('#iframeDeliveryExec');\n            $('#tools').css('height', 'auto');\n            \n            var serviceApi = options.serviceApi;\n\n            serviceApi.onFinish(function() {\n                $.ajax({\n                    url : options.finishDeliveryExecution,\n                    data : {\n                        'deliveryExecution' : options.deliveryExecution\n                    },\n                    type : 'post',\n                    dataType : 'json',\n                    success : function(data) {\n                        window.location = data.destination;\n                    }\n                });\n            });\n            \n            $(document)\n                .on('loading', function(e, reverse){\n                    loading(reverse);\n                })\n                .on('unloading', function(){\n                    unloading();\n                })\n                .on('shutdown-com', function(){\n                    //use when we want to stop all exchange between frames\n                    $(document).off('heightchange');\n                    $frame.off('load.eventHeight')\n                           .off('load.cors');\n                });\n            \n            serviceApi.loadInto($frame.get(0));\n            \n            $(window).bind('resize', function() {\n                resizeMainFrame();\n            });\n            \n            resizeMainFrame();\n        }\n    };\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\n(function(){\n    //the url of the app config is set into the data-config attr of the loader.\n    var appConfig = document.getElementById('amd-loader').getAttribute('data-config');\n    require([appConfig], function(){\n   \n        require(['jquery'], function($){\n            $('ul li').mouseover(function() {\n                $(\"a .actionsBox .button\", this).addClass(\"buttonSelected\");\n            });\n            $('ul li').mouseleave(function() {\n                $(\"a .actionsBox .button\", this).removeClass(\"buttonSelected\");\n            });\n        });\n    });\n\n}());\n\ndefine(\"taoDelivery/controller/runtime/index\", function(){});\n\n"]}